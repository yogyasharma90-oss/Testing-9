<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cake Decoration ðŸŽ‚</title>

<style>
body{
  margin:0;
  background:black;
  font-family: "Segoe UI", sans-serif;
  overflow:hidden;
}

.container{
  width:100vw;
  height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  position:relative;
}

/* Cake */
.cake-area{
  position:relative;
  width:320px;
}

.cake{
  width:100%;
  display:block;
}

/* Toppings & candles container */
.layer{
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  pointer-events:none;
}

.item{
  position:absolute;
  transform:translate(-50%,-50%);
}

/* Flame */
.flame{
  width:20px;
  position:absolute;
  top:-22px;
  left:50%;
  transform:translateX(-50%);
  display:none;
}

/* Buttons */
.btn{
  background:linear-gradient(135deg,#ff4fa3,#ff85c6);
  border:none;
  color:white;
  padding:12px 22px;
  border-radius:30px;
  font-size:15px;
  cursor:pointer;
  margin:6px;
}

.btn.small{
  padding:8px 14px;
  font-size:13px;
}

.panel{
  position:absolute;
  right:0;
  top:0;
  height:100%;
  width:240px;
  background:rgba(255,255,255,0.08);
  backdrop-filter:blur(10px);
  padding:15px;
  display:none;
  flex-direction:column;
}

.panel h3{
  color:white;
  text-align:center;
}

.panel button{
  margin:6px 0;
}

/* Bottom controls */
.controls{
  margin-top:20px;
}

/* Text */
.wish{
  position:absolute;
  top:40px;
  font-family:cursive;
  font-size:34px;
  color:white;
  display:none;
}

/* Confetti */
.confetti{
  position:absolute;
  width:8px;
  height:12px;
  background:red;
  top:-20px;
  animation:fall 2.5s linear forwards;
}

@keyframes fall{
  to{
    transform:translateY(110vh) rotate(720deg);
    opacity:0;
  }
}

.back-btn{
  position:absolute;
  bottom:20px;
  display:none;
}
</style>
</head>

<body>
<div class="container">

  <div class="wish">Make a wish âœ¨</div>

  <div class="cake-area">
    <img src="chococake.png" class="cake">

    <div class="layer" id="toppingsLayer"></div>
    <div class="layer" id="candlesLayer"></div>
  </div>

  <div class="controls">
    <button class="btn" onclick="openMainPanel()">Decorate</button>
    <button class="btn" id="finishBtn" style="display:none" onclick="finishDecor()">Finished Decorating</button>
    <button class="btn" id="lightBtn" style="display:none" onclick="lightCandles()">Light the candle</button>
    <button class="btn" id="blowBtn" style="display:none" onclick="blowCandles()">Blow the candle</button>
  </div>

  <button class="btn back-btn" id="backBtn" onclick="location.href='present.html'">Back</button>

  <!-- PANEL -->
  <div class="panel" id="panel">
    <h3 id="panelTitle"></h3>
    <div id="panelContent"></div>
  </div>

</div>

<script>
const panel = document.getElementById("panel");
const panelContent = document.getElementById("panelContent");
const panelTitle = document.getElementById("panelTitle");

function openMainPanel(){
  panel.style.display="flex";
  panelTitle.innerText="Decorations";
  panelContent.innerHTML=`
    <button class="btn small" onclick="openCandles()">Candles</button>
    <button class="btn small" onclick="openToppings()">Toppings</button>
  `;
  document.getElementById("finishBtn").style.display="inline-block";
}

function backToMain(){
  openMainPanel();
}

/* ===== TOPPINGS ===== */
function openToppings(){
  panelTitle.innerText="Toppings";
  panelContent.innerHTML=`
    <button class="btn small" onclick="addTopping('strawberry.png')">Strawberry</button>
    <button class="btn small" onclick="addTopping('blueberry.png')">Blueberry</button>
    <button class="btn small" onclick="addTopping('cherry.png')">Cherry</button>
    <button class="btn small" onclick="addTopping('oreo.png')">Oreos</button>
    <button class="btn small" onclick="addTopping('sprinkles.png')">Sprinkles</button>
    <button class="btn small" onclick="backToMain()">Back</button>
    <button class="btn small" onclick="resetLayer('toppingsLayer')">Reset</button>
  `;
}

function addTopping(img){
  const layer = document.getElementById("toppingsLayer");
  layer.innerHTML="";
  const positions = [
    [50,12],[20,25],[80,25],[15,50],[85,50],[30,75],[70,75]
  ];
  positions.forEach(p=>{
    const el=document.createElement("img");
    el.src="assets/"+img;
    el.className="item";
    el.style.width="40px";
    el.style.left=p[0]+"%";
    el.style.top=p[1]+"%";
    layer.appendChild(el);
  });
}

/* ===== CANDLES ===== */
function openCandles(){
  panelTitle.innerText="Candles";
  panelContent.innerHTML=`
    <button class="btn small" onclick="addCandles('simple')">Simple</button>
    <button class="btn small" onclick="addCandles('heart')">Heart</button>
    <button class="btn small" onclick="addCandles('age')">Age</button>
    <button class="btn small" onclick="backToMain()">Back</button>
    <button class="btn small" onclick="resetLayer('candlesLayer')">Reset</button>
  `;
}

function addCandles(type){
  const layer=document.getElementById("candlesLayer");
  layer.innerHTML="";

  let data=[];
  if(type==="age"){
    data=[[50,18,"candle-age.png"]];
  }else{
    data=[
      [30,20,`candle-${type}.png`],
      [50,15,`candle-${type}.png`],
      [70,20,`candle-${type}.png`]
    ];
  }

  data.forEach(d=>{
    const wrap=document.createElement("div");
    wrap.className="item";
    wrap.style.left=d[0]+"%";
    wrap.style.top=d[1]+"%";

    const img=document.createElement("img");
    img.src="assets/"+d[2];
    img.style.width="22px";

    const flame=document.createElement("img");
    flame.src="assets/flame.gif";
    flame.className="flame";

    wrap.appendChild(img);
    wrap.appendChild(flame);
    layer.appendChild(wrap);
  });
}

/* ===== FLOW ===== */
function finishDecor(){
  panel.style.display="none";
  document.getElementById("finishBtn").style.display="none";
  document.getElementById("lightBtn").style.display="inline-block";
}

function lightCandles(){
  document.querySelectorAll(".flame").forEach(f=>f.style.display="block");
  document.querySelector(".wish").style.display="block";
  document.getElementById("lightBtn").style.display="none";
  document.getElementById("blowBtn").style.display="inline-block";
}

function blowCandles(){
  document.querySelectorAll(".flame").forEach(f=>f.style.display="none");
  document.querySelector(".wish").innerText="HAPPY BIRTHDAY ðŸŽ‰";
  confettiBlast();
  document.getElementById("blowBtn").style.display="none";
  setTimeout(()=>document.getElementById("backBtn").style.display="block",2500);
}

/* ===== UTIL ===== */
function resetLayer(id){
  document.getElementById(id).innerHTML="";
}

function confettiBlast(){
  for(let i=0;i<150;i++){
    const c=document.createElement("div");
    c.className="confetti";
    c.style.left=Math.random()*100+"vw";
    c.style.background=`hsl(${Math.random()*360},100%,60%)`;
    c.style.animationDelay=Math.random()*0.3+"s";
    document.body.appendChild(c);
    setTimeout(()=>c.remove(),3000);
  }
}
</script>
</body>
</html>
